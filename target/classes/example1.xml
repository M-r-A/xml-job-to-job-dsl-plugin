<?xml version="1.0" encoding="UTF-8"?>
<project>
    <actions/>
    <description/>
    <keepDependencies>false</keepDependencies>
    <properties>
        <hudson.plugins.buildblocker.BuildBlockerProperty>
            <useBuildBlocker>true</useBuildBlocker>
            <blockingJobs>Build-iOS-App
                Build-Android-App
                Run-iOS-Tests
                Run-Android-Tests
            </blockingJobs>
            <blockLevel>GLOBAL</blockLevel>
            <scanQueueFor>DISABLED</scanQueueFor>
        </hudson.plugins.buildblocker.BuildBlockerProperty>
        <hudson.model.ParametersDefinitionProperty>
            <parameterDefinitions>
                <hudson.model.StringParameterDefinition>
                    <name>REMOTE_USER</name>
                    <defaultValue>jenkins</defaultValue>
                    <description>User of the slave machines to log in</description>
                </hudson.model.StringParameterDefinition>
                <com.cloudbees.plugins.credentials.CredentialsParameterDefinition>
                    <name>PASS_WORD</name>
                    <description>Credential of type "Secret Text" with the password used to log in slave machines</description>
                    <defaultValue>JenkinsMachinePassword</defaultValue>
                    <credentialType>org.jenkinsci.plugins.plaincredentials.impl.StringCredentialsImpl</credentialType>
                    <required>false</required>
                </com.cloudbees.plugins.credentials.CredentialsParameterDefinition>
                <hudson.model.ChoiceParameterDefinition>
                    <choices class="java.util.Arrays$ArrayList">
                        <a class="string-array">
                            <string>cip1-qa</string>
                            <string>cip2-qa</string>
                            <string>cip3-qa</string>
                            <string>cip4-qa</string>
                            <string>qa4</string>
                            <string>qa3</string>
                            <string>qa5</string>
                            <string>qa6</string>
                            <string>qa10</string>
                            <string>qa12</string>
                            <string>qa20</string>
                            <string>qa22</string>
                            <string>qa24</string>
                            <string>qa26</string>
                            <string>qa27</string>
                            <string>warpdrive</string>
                        </a>
                    </choices>
                    <name>POD</name>
                    <description/>
                </hudson.model.ChoiceParameterDefinition>
                <hudson.model.ChoiceParameterDefinition>
                    <choices class="java.util.Arrays$ArrayList">
                        <a class="string-array">
                            <string>cip3-qa</string>
                            <string>cip2-qa</string>
                            <string>cip1-qa</string>
                            <string>cip4-qa</string>
                            <string>qa4</string>
                            <string>qa3</string>
                            <string>qa5</string>
                            <string>qa6</string>
                            <string>qa10</string>
                            <string>qa12</string>
                            <string>qa20</string>
                            <string>qa22</string>
                            <string>qa24</string>
                            <string>qa26</string>
                            <string>qa27</string>
                            <string>warpdrive</string>
                        </a>
                    </choices>
                    <name>XPOD</name>
                    <description/>
                </hudson.model.ChoiceParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>STORIES</name>
                    <defaultValue>all</defaultValue>
                    <description/>
                </hudson.model.StringParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>TESTRAIL_RUN_ID</name>
                    <defaultValue>None</defaultValue>
                    <description>Use this to have the tests post their status into an existing Testrail run instead of creating a new one.
                        Enter the ID of the run into this field or leave it as "None" to have the tests create a new one.
                        E.g.: 692, 677, 123</description>
                </hudson.model.StringParameterDefinition>
                <hudson.model.ChoiceParameterDefinition>
                    <choices class="java.util.Arrays$ArrayList">
                        <a class="string-array">
                            <string>warn</string>
                            <string>debug</string>
                            <string>info</string>
                        </a>
                    </choices>
                    <name>LOG_LEVEL</name>
                    <description>This is the Appium log level</description>
                </hudson.model.ChoiceParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>URLS</name>
                    <defaultValue>10.240.50.18:4723,10.240.50.36:4723,10.240.50.37:4723</defaultValue>
                    <description>List of URL:PORT for all Appium's servers
                        Use ODD Ports for iOS Parallel Tests.
                        Use EVEN Ports for Android Parallel Tests.
                        127.0.0.1 for localhost.
                        Comma separated</description>
                </hudson.model.StringParameterDefinition>
                <hudson.model.ChoiceParameterDefinition>
                    <choices class="java.util.Arrays$ArrayList">
                        <a class="string-array">
                            <string>none</string>
                            <string>smoke</string>
                            <string>sanity</string>
                        </a>
                    </choices>
                    <name>METAFILTER</name>
                    <description/>
                </hudson.model.ChoiceParameterDefinition>
                <hudson.model.BooleanParameterDefinition>
                    <name>DONT_RESET_APP</name>
                    <defaultValue>false</defaultValue>
                    <description>Check this if you want to avoid resetting app between stories</description>
                </hudson.model.BooleanParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>GIT_BRANCH</name>
                    <defaultValue>dev</defaultValue>
                    <description>Name of the branch that will be checked out from SymphonyOSF/iOSTest Repo</description>
                </hudson.model.StringParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>SELECTED_BINARY</name>
                    <defaultValue>none</defaultValue>
                    <description>Local path of binary to run the tests against</description>
                </hudson.model.StringParameterDefinition>
                <hudson.model.BooleanParameterDefinition>
                    <name>REAL_DEVICE</name>
                    <defaultValue>false</defaultValue>
                    <description>Check this if you want to run on a plugged in device instead of the simulator
                        Make sure only one device is plugged.
                        UDID will be automatically fetched</description>
                </hudson.model.BooleanParameterDefinition>
                <hudson.model.StringParameterDefinition>
                    <name>APP_VERSION</name>
                    <defaultValue>latest-dev</defaultValue>
                    <description>The version of the app used to run the tests against
                        * The default value "latest-qa" gets the latest github tag starting with "qa-" for the android app repo
                        * "latest-dev" gets the latest github tag starting with "dev-" from the app repo

                        Examples:
                        latest-qa
                        latest-dev
                        qa-123
                        dev-321

                        A list of available versions can be found here:
                        https://github.com/SymphonyOSF/SANDROID-CLIENT-APP/tags</description>
                </hudson.model.StringParameterDefinition>
            </parameterDefinitions>
        </hudson.model.ParametersDefinitionProperty>
        <com.coravy.hudson.plugins.github.GithubProjectProperty>
            <projectUrl>https://github.com/SymphonyOSF/iOSTest/</projectUrl>
        </com.coravy.hudson.plugins.github.GithubProjectProperty>
    </properties>
    <canRoam>true</canRoam>
    <disabled>false</disabled>
    <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
    <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
    <triggers/>
    <concurrentBuild>false</concurrentBuild>
    <builders>
        <org.jenkinsci.plugins.buildnameupdater.BuildNameUpdater plugin="build-name-setter@1.6.5">
            <macroTemplate>Test iOS App #${BUILD_NUMBER} | ${APP_VERSION}</macroTemplate>
            <fromFile>false</fromFile>
            <fromMacro>true</fromMacro>
            <macroFirst>true</macroFirst>
        </org.jenkinsci.plugins.buildnameupdater.BuildNameUpdater>
        <hudson.tasks.Shell>
            <command>export PLATFORM=iOS
                cd 'iOSTest-AppiumTests/src/scripts/'
                fab -f test.py initialize_env run_appium run_tests kill_appium
            </command>
        </hudson.tasks.Shell>
    </builders>
    <publishers>
        <hudson.tasks.ArtifactArchiver>
            <artifacts>iOSTest-AppiumTests/target/test-output/**/*</artifacts>
            <allowEmptyArchive>false</allowEmptyArchive>
            <defaultExcludes>true</defaultExcludes>
            <fingerprint>false</fingerprint>
            <onlyIfSuccessful>false</onlyIfSuccessful>
        </hudson.tasks.ArtifactArchiver>
        <org.korosoft.jenkins.plugin.rtp.RichTextPublisher plugin="rich-text-publisher-plugin@1.4">
            <stableText>${FILE:iOSTest-AppiumTests/testrail_report.html}
                ${FILE:build_variables.html}</stableText>
            <unstableText/>
            <failedText/>
            <abortedText/>
            <nullAction/>
            <unstableAsStable>true</unstableAsStable>
            <failedAsStable>true</failedAsStable>
            <abortedAsStable>true</abortedAsStable>
            <parserName>HTML</parserName>
        </org.korosoft.jenkins.plugin.rtp.RichTextPublisher>
    </publishers>
    <buildWrappers>
        <org.jenkinsci.plugins.credentialsbinding.impl.SecretBuildWrapper>
            <bindings>
                <org.jenkinsci.plugins.credentialsbinding.impl.StringBinding>
                    <variable>PASSWORD</variable>
                    <credentialsId>${PASS_WORD}</credentialsId>
                </org.jenkinsci.plugins.credentialsbinding.impl.StringBinding>
            </bindings>
        </org.jenkinsci.plugins.credentialsbinding.impl.SecretBuildWrapper>
    </buildWrappers>
    <logRotator>
        <daysToKeep>50</daysToKeep>
        <numToKeep>-1</numToKeep>
        <artifactDaysToKeep>-1</artifactDaysToKeep>
        <artifactNumToKeep>-1</artifactNumToKeep>
    </logRotator>
    <scm class="hudson.plugins.git.GitSCM">
        <userRemoteConfigs>
            <hudson.plugins.git.UserRemoteConfig>
                <url>https://github.com/SymphonyOSF/iOSTest.git</url>
                <credentialsId>jenkins-mobile</credentialsId>
            </hudson.plugins.git.UserRemoteConfig>
        </userRemoteConfigs>
        <branches>
            <hudson.plugins.git.BranchSpec>
                <name>*/${GIT_BRANCH}</name>
            </hudson.plugins.git.BranchSpec>
        </branches>
        <configVersion>2</configVersion>
        <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
        <gitTool>Default</gitTool>
        <extensions>
            <hudson.plugins.git.extensions.impl.WipeWorkspace/>
        </extensions>
        <browser class="hudson.plugins.git.browser.GithubWeb">
            <url>https://github.com/SymphonyOSF/iOSTest/</url>
        </browser>
    </scm>
</project>